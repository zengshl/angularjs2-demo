var metadata_1 = require("./metadata");
var map_1 = require("../shim/map");
var _Map = typeof Map === "function" ? Map : map_1.createMapPolyfill();
// https://github.com/jonathandturner/decorators/blob/master/specs/metadata.md#getorcreatemetadatamap--o-p-create-
function getOrCreateMetadataMap(target, targetKey, create) {
    var targetMetadata = metadata_1.__Metadata__.get(target);
    if (!targetMetadata) {
        if (!create) {
            return undefined;
        }
        // TODO: fix the typescript types
        // targetMetadata = new _Map<string | symbol, _Map<any, any>>();
        targetMetadata = new _Map();
        metadata_1.__Metadata__.set(target, targetMetadata);
    }
    var keyMetadata = targetMetadata.get(targetKey);
    if (!keyMetadata) {
        if (!create) {
            return undefined;
        }
        // TODO: fix the typescript types
        // keyMetadata = new _Map<any, any>();
        keyMetadata = new _Map();
        targetMetadata.set(targetKey, keyMetadata);
    }
    return keyMetadata;
}
exports.getOrCreateMetadataMap = getOrCreateMetadataMap;
//# sourceMappingURL=get-or-create-metadata-map.js.map